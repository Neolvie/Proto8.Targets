<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ò–ò-–ø–æ–º–æ—â–Ω–∏–∫ Directum Targets</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <header class="header">
    <span class="header-logo">Directum Ario</span>
    <span class="header-subtitle">–ò–ò-–ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ü–µ–ª—è–º–∏</span>
    <nav class="header-nav">
      <a href="/backoffice" target="_blank">–ë—ç–∫-–æ—Ñ–∏—Å</a>
    </nav>
  </header>

  <main class="container">
    <!-- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã -->
    <div id="global-alert" class="hidden"></div>

    <!-- ===== –°–ï–ö–¶–ò–Ø –ó–ê–ì–†–£–ó–ö–ò ===== -->
    <div id="section-upload" class="section active">
      <div class="upload-section">
        <h1 class="upload-title">–ò–ò-–ø–æ–º–æ—â–Ω–∏–∫ –ø–æ —Ü–µ–ª—è–º</h1>
        <p class="upload-subtitle">–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–∞—Ä—Ç—É —Ü–µ–ª–µ–π –∏–∑ Directum Targets, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∞–Ω–∞–ª–∏–∑</p>

        <!-- –ö–Ω–æ–ø–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö -->
        <button class="test-data-btn" id="btn-load-test" onclick="loadTestData()">
          –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞—Ä—Ç—É —Ü–µ–ª–µ–π: –ö–∞—Ä—Ç–∞ —Ü–µ–ª–µ–π Ario 2026
        </button>

        <div class="upload-separator" style="margin-top:32px">–∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å–≤–æ–∏ —Ñ–∞–π–ª—ã</div>

        <div class="upload-grid">
          <!-- JSON –∑–æ–Ω–∞ -->
          <div class="card">
            <div class="card-title">–ö–∞—Ä—Ç–∞ —Ü–µ–ª–µ–π (JSON)</div>
            <div class="upload-zone" id="json-zone" onclick="document.getElementById('json-file-input').click()"
                 ondrop="handleFileDrop(event, 'json')" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
              <div class="upload-zone-icon">üìä</div>
              <div class="upload-zone-title" id="json-zone-title">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ JSON-—Ñ–∞–π–ª</div>
              <div class="upload-zone-hint">–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</div>
              <input type="file" id="json-file-input" accept=".json" onchange="handleFileSelect(event, 'json')">
            </div>
            <div class="upload-separator">–∏–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ JSON</div>
            <textarea class="json-textarea" id="json-text-input" placeholder='{"Payload": {"Nodes": [...]}}' rows="4"></textarea>
          </div>

          <!-- DOCX –∑–æ–Ω–∞ -->
          <div class="card">
            <div class="card-title">–û–ø–∏—Å–∞–Ω–∏–µ —Ü–µ–ª–∏ (DOCX) ‚Äî –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ</div>
            <div class="upload-zone" id="docx-zone" onclick="document.getElementById('docx-file-input').click()"
                 ondrop="handleFileDrop(event, 'docx')" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
              <div class="upload-zone-icon">üìÑ</div>
              <div class="upload-zone-title" id="docx-zone-title">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ DOCX-—Ñ–∞–π–ª</div>
              <div class="upload-zone-hint">–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</div>
              <input type="file" id="docx-file-input" accept=".docx" onchange="handleFileSelect(event, 'docx')">
            </div>
            <div class="mt-16 text-muted" style="font-size:12px">
              DOCX –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫–µ–π—Å–æ–≤ 1, 2, 4: –∞–Ω–∞–ª–∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ü–µ–ª–∏
            </div>
          </div>
        </div>

        <button class="btn btn-primary btn-lg" onclick="uploadUserData()" style="min-width:200px">
          –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –Ω–∞—á–∞—Ç—å –∞–Ω–∞–ª–∏–∑
        </button>
      </div>
    </div>

    <!-- ===== –°–ï–ö–¶–ò–Ø –ö–ï–ô–°–û–í –ò –ß–ê–¢–ê ===== -->
    <div id="section-main" class="section">
      <!-- –®–∞–ø–∫–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–∞—Ä—Ç–µ -->
      <div class="cases-header">
        <h2>–ê–Ω–∞–ª–∏–∑ –∫–∞—Ä—Ç—ã —Ü–µ–ª–µ–π</h2>
        <div class="map-info" id="map-info">–ö–∞—Ä—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞</div>
        <button class="btn btn-secondary btn-sm" onclick="resetApp()">‚Üê –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥—Ä—É–≥—É—é –∫–∞—Ä—Ç—É</button>
      </div>

      <!-- –í–∫–ª–∞–¥–∫–∏ -->
      <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('cases', this)">7 –∫–µ–π—Å–æ–≤ OKR</button>
        <button class="tab-btn" onclick="switchTab('chat', this)">–°–≤–æ–±–æ–¥–Ω—ã–π —á–∞—Ç</button>
      </div>

      <!-- –í–∫–ª–∞–¥–∫–∞ –∫–µ–π—Å–æ–≤ -->
      <div id="tab-cases" class="tab-content active">
        <!-- –í—ã–±–æ—Ä —Ü–µ–ª–∏ -->
        <div class="goal-selector">
          <label for="goal-select">–í—ã–±—Ä–∞–Ω–Ω–∞—è —Ü–µ–ª—å:</label>
          <select class="goal-select" id="goal-select">
            <option value="">‚Äî –≤—ã–±–µ—Ä–∏—Ç–µ —Ü–µ–ª—å –¥–ª—è –∫–µ–π—Å–æ–≤ 1-4 –∏ 6 ‚Äî</option>
          </select>
        </div>

        <!-- –°–µ—Ç–∫–∞ –∫–µ–π—Å–æ–≤ -->
        <div class="cases-grid" id="cases-grid">
          <!-- –ö–µ–π—Å 1 -->
          <div class="case-card">
            <div class="case-number">–ö–µ–π—Å 1</div>
            <div class="case-title">–§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –æ–ø–∏—Å–∞–Ω–∏—è —Ü–µ–ª–∏</div>
            <div class="case-desc">–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ SMART-–∫—Ä–∏—Ç–µ—Ä–∏–∏, –∞–º–±–∏—Ü–∏–æ–∑–Ω–æ—Å—Ç—å –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è 2-3 —É–ª—É—á—à–µ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</div>
            <div class="case-footer">
              <span class="case-tag">–ù—É–∂–Ω–∞ —Ü–µ–ª—å</span>
              <button class="btn btn-primary btn-sm" onclick="runCase(1)">–ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
            </div>
          </div>

          <!-- –ö–µ–π—Å 2 -->
          <div class="case-card">
            <div class="case-number">–ö–µ–π—Å 2</div>
            <div class="case-title">–§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</div>
            <div class="case-desc">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è 3-4 –Ω–∞–±–æ—Ä–æ–≤ –∏–∑–º–µ—Ä–∏–º—ã—Ö KR –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ü–µ–ª–∏</div>
            <div class="case-footer">
              <span class="case-tag">–ù—É–∂–Ω–∞ —Ü–µ–ª—å</span>
              <button class="btn btn-primary btn-sm" onclick="runCase(2)">–ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
            </div>
          </div>

          <!-- –ö–µ–π—Å 3 -->
          <div class="case-card">
            <div class="case-number">–ö–µ–π—Å 3</div>
            <div class="case-title">–î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –Ω–∞ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ —Ü–µ–ª–∏</div>
            <div class="case-desc">–†–∞–∑–±–∏–≤–∫–∞ –≥–æ–¥–æ–≤–æ–π —Ü–µ–ª–∏ –Ω–∞ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –ø–æ–¥—Ü–µ–ª–∏ —Å —É—á—ë—Ç–æ–º —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏</div>
            <div class="case-footer">
              <span class="case-tag">–ù—É–∂–Ω–∞ —Ü–µ–ª—å</span>
              <button class="btn btn-primary btn-sm" onclick="runCase(3)">–ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
            </div>
          </div>

          <!-- –ö–µ–π—Å 4 -->
          <div class="case-card">
            <div class="case-number">–ö–µ–π—Å 4</div>
            <div class="case-title">–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –æ–∂–∏–¥–∞–Ω–∏—è–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞</div>
            <div class="case-desc">–ß–µ–∫–ª–∏—Å—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ü–µ–ª–∏ –æ–∂–∏–¥–∞–Ω–∏—è–º –∏ –∑–∞–º–µ—á–∞–Ω–∏—è–º –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è</div>
            <div class="case-footer">
              <span class="case-tag">–ù—É–∂–Ω–∞ —Ü–µ–ª—å</span>
              <button class="btn btn-primary btn-sm" onclick="runCase(4)">–ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
            </div>
          </div>

          <!-- –ö–µ–π—Å 5 -->
          <div class="case-card">
            <div class="case-number">–ö–µ–π—Å 5</div>
            <div class="case-title">–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏ —Å–ª–µ–ø—ã–µ –∑–æ–Ω—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏</div>
            <div class="case-desc">–ê–Ω–∞–ª–∏–∑ –≤—Å–µ–π –∫–∞—Ä—Ç—ã —Ü–µ–ª–µ–π –Ω–∞ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è, –ø—Ä–æ–±–µ–ª—ã –∏ –¥–∏—Å–±–∞–ª–∞–Ω—Å</div>
            <div class="case-footer">
              <span class="case-tag">–í—Å—è –∫–∞—Ä—Ç–∞</span>
              <button class="btn btn-primary btn-sm" onclick="runCase(5)">–ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
            </div>
          </div>

          <!-- –ö–µ–π—Å 6 -->
          <div class="case-card">
            <div class="case-number">–ö–µ–π—Å 6</div>
            <div class="case-title">–†–∏—Å–∫–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏</div>
            <div class="case-desc">–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∏—Å–∫–æ–≤ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ –º–∏—Ç–∏–≥–∞—Ü–∏–∏</div>
            <div class="case-footer">
              <span class="case-tag">–ù—É–∂–Ω–∞ —Ü–µ–ª—å</span>
              <button class="btn btn-primary btn-sm" onclick="runCase(6)">–ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
            </div>
          </div>

          <!-- –ö–µ–π—Å 7 -->
          <div class="case-card">
            <div class="case-number">–ö–µ–π—Å 7</div>
            <div class="case-title">–≠–∫—Å–ø—Ä–µ—Å—Å-–æ—Ç—á—ë—Ç –ø–æ —Ü–µ–ª—è–º</div>
            <div class="case-desc">–¢–æ–ø-3 —Ü–µ–ª–∏ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –æ—Ç—Å—Ç–∞–≤–∞–Ω–∏–µ–º –∏ –æ–±—â–∞—è —Å–≤–æ–¥–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è</div>
            <div class="case-footer">
              <span class="case-tag">–í—Å—è –∫–∞—Ä—Ç–∞</span>
              <button class="btn btn-primary btn-sm" onclick="runCase(7)">–ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
            </div>
          </div>
        </div>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç -->
        <div id="result-area" class="result-area hidden">
          <div class="result-header">
            <div class="result-case-label" id="result-case-label">–ö–µ–π—Å N</div>
            <div id="result-loading" class="result-loading">
              <span class="spinner"></span> –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞...
            </div>
          </div>
          <div class="result-content" id="result-content"></div>
          <div class="feedback-bar hidden" id="feedback-bar">
            <span class="feedback-label">–û—Ü–µ–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</span>
            <button class="feedback-btn" id="btn-thumbs-up" onclick="sendFeedback(1)">üëç</button>
            <button class="feedback-btn" id="btn-thumbs-down" onclick="sendFeedback(-1)">üëé</button>
            <span id="feedback-sent" class="text-muted hidden" style="font-size:12px">–û—Ü–µ–Ω–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞</span>
          </div>
        </div>
      </div>

      <!-- –í–∫–ª–∞–¥–∫–∞ —á–∞—Ç–∞ -->
      <div id="tab-chat" class="tab-content">
        <div class="chat-container">
          <div class="chat-messages" id="chat-messages">
            <div class="chat-message assistant">
              –ü—Ä–∏–≤–µ—Ç! –Ø –≥–æ—Ç–æ–≤ –ø–æ–º–æ—á—å –≤–∞–º –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—Ç—É —Ü–µ–ª–µ–π. –ó–∞–¥–∞–π—Ç–µ –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å –æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ü–µ–ª—è—Ö, –ø–æ–ø—Ä–æ—Å–∏—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ–∏ –∏–ª–∏ —É—Ç–æ—á–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–µ–π—Å–æ–≤.
            </div>
          </div>
          <div class="chat-input-area">
            <textarea
              class="chat-input"
              id="chat-input"
              placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–æ–ø—Ä–æ—Å... (Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏)"
              rows="1"
              onkeydown="handleChatKeydown(event)"
            ></textarea>
            <button class="btn btn-primary" onclick="sendChatMessage()" id="btn-chat-send">
              –û—Ç–ø—Ä–∞–≤–∏—Ç—å
            </button>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script src="/static/app.js"></script>
</body>
</html>
